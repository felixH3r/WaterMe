{"version":3,"file":"typeahead-container.component.js","sources":["../../src/typeahead/typeahead-container.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component, ElementRef, TemplateRef, ViewEncapsulation, HostListener\n} from '@angular/core';\nimport { isBs3 } from '../utils/ng2-bootstrap-config';\nimport { TypeaheadUtils } from './typeahead-utils';\nimport { TypeaheadDirective } from './typeahead.directive';\nimport { TypeaheadMatch } from './typeahead-match.class';\n\n\nexport class TypeaheadContainerComponent {\n  public parent: TypeaheadDirective;\n  public query: any;\n  public element: ElementRef;\n  public isFocused: boolean = false;\n  public top: string;\n  public left: string;\n  public display: string;\n  public placement: string;\n\n  public get isBs4():boolean {\n    return !isBs3();\n  }\n\n  protected _active: TypeaheadMatch;\n  protected _matches: TypeaheadMatch[] = [];\n\n  public constructor(element: ElementRef) {\n    this.element = element;\n  }\n\n  public get active(): TypeaheadMatch {\n    return this._active;\n  }\n\n  public get matches(): TypeaheadMatch[] {\n    return this._matches;\n  }\n\n  public set matches(value: TypeaheadMatch[]) {\n    this._matches = value;\n\n    if (this._matches.length > 0) {\n      this._active = this._matches[0];\n      if (this._active.isHeader()) {\n        this.nextActiveMatch();\n      }\n    }\n  }\n\n  public get optionsListTemplate(): TemplateRef<any> {\n    return this.parent ? this.parent.optionsListTemplate : undefined;\n  }\n\n  public get itemTemplate(): TemplateRef<any> {\n    return this.parent ? this.parent.typeaheadItemTemplate : undefined;\n  }\n\n  public selectActiveMatch(): void {\n    this.selectMatch(this._active);\n  }\n\n  public prevActiveMatch(): void {\n    let index = this.matches.indexOf(this._active);\n    this._active = this.matches[index - 1 < 0\n      ? this.matches.length - 1\n      : index - 1];\n    if (this._active.isHeader()) {\n      this.prevActiveMatch();\n    }\n\n  }\n\n  public nextActiveMatch(): void {\n    let index = this.matches.indexOf(this._active);\n    this._active = this.matches[index + 1 > this.matches.length - 1\n      ? 0\n      : index + 1];\n    if (this._active.isHeader()) {\n      this.nextActiveMatch();\n    }\n  }\n\n  public selectActive(value: TypeaheadMatch): void {\n    this.isFocused = true;\n    this._active = value;\n  }\n\n  public hightlight(match: TypeaheadMatch, query: any): string {\n    let itemStr: string = match.value;\n    let itemStrHelper: string = (this.parent && this.parent.typeaheadLatinize\n      ? TypeaheadUtils.latinize(itemStr)\n      : itemStr).toLowerCase();\n    let startIdx: number;\n    let tokenLen: number;\n    // Replaces the capture string with the same string inside of a \"strong\" tag\n    if (typeof query === 'object') {\n      let queryLen: number = query.length;\n      for (let i = 0; i < queryLen; i += 1) {\n        // query[i] is already latinized and lower case\n        startIdx = itemStrHelper.indexOf(query[i]);\n        tokenLen = query[i].length;\n        if (startIdx >= 0 && tokenLen > 0) {\n          itemStr = itemStr.substring(0, startIdx) + '<strong>' + itemStr.substring(startIdx, startIdx + tokenLen) + '</strong>' + itemStr.substring(startIdx + tokenLen);\n          itemStrHelper = itemStrHelper.substring(0, startIdx) + '        ' + ' '.repeat(tokenLen) + '         ' + itemStrHelper.substring(startIdx + tokenLen);\n        }\n      }\n    } else if (query) {\n      // query is already latinized and lower case\n      startIdx = itemStrHelper.indexOf(query);\n      tokenLen = query.length;\n      if (startIdx >= 0 && tokenLen > 0) {\n        itemStr = itemStr.substring(0, startIdx) + '<strong>' + itemStr.substring(startIdx, startIdx + tokenLen) + '</strong>' + itemStr.substring(startIdx + tokenLen);\n      }\n    }\n    return itemStr;\n  }\n\n  \n  \n  public focusLost(): void {\n    this.isFocused = false;\n  }\n\n  public isActive(value: TypeaheadMatch): boolean {\n    return this._active === value;\n  }\n\n  public selectMatch(value: TypeaheadMatch, e: Event = void 0): boolean {\n    if (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n    this.parent.changeModel(value);\n    setTimeout(() =>\n      this.parent.typeaheadOnSelect.emit(value), 0\n    );\n    return false;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'typeahead-container',\n  // tslint:disable-next-line\n  template: `\n<!-- inject options list template -->\n<template [ngTemplateOutlet]=\"optionsListTemplate || (isBs4 ? bs4Template : bs3Template)\"\n  [ngOutletContext]=\"{matches:matches, itemTemplate:itemTemplate, query:query}\"></template>\n\n<!-- default options item template -->\n<template #bsItemTemplate let-match=\"match\" let-query=\"query\"><span [innerHtml]=\"hightlight(match, query)\"></span></template>\n\n<!-- Bootstrap 3 options list template -->\n<template #bs3Template>\n<ul class=\"dropdown-menu\">\n  <template ngFor let-match let-i=\"index\" [ngForOf]=\"matches\">\n    <li *ngIf=\"match.isHeader()\" class=\"dropdown-header\">{{match}}</li>\n    <li *ngIf=\"!match.isHeader()\" [class.active]=\"isActive(match)\" (mouseenter)=\"selectActive(match)\">\n      <a href=\"#\" (click)=\"selectMatch(match, $event)\" tabindex=\"-1\">\n        <template [ngTemplateOutlet]=\"itemTemplate || bsItemTemplate\" \n          [ngOutletContext]=\"{item:match.item, index:i, match:match, query:query}\"></template>\n      </a>\n    </li>\n  </template>\n</ul>\n</template>\n\n<!-- Bootstrap 4 options list template -->\n<template #bs4Template >\n<template ngFor let-match let-i=\"index\" [ngForOf]=\"matches\">\n   <h6 *ngIf=\"match.isHeader()\" class=\"dropdown-header\">{{match}}</h6>\n   <template [ngIf]=\"!match.isHeader()\">\n      <button\n        class=\"dropdown-item\"\n        (click)=\"selectMatch(match, $event)\"\n        (mouseenter)=\"selectActive(match)\"\n        [class.active]=\"isActive(match)\">\n          <template [ngTemplateOutlet]=\"itemTemplate || bsItemTemplate\" \n            [ngOutletContext]=\"{item:match.item, index:i, match:match, query:query}\"></template>\n      </button>\n  </template>\n</template>\n</template>\n`,\n  // tslint:disable\n  host: {\n    'class': 'dropdown open',\n    '[class.dropdown-menu]':'isBs4',\n    style: 'position: absolute;display: block;'\n  },\n  // tslint: enable\n  encapsulation: ViewEncapsulation.None\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'focusLost': [{ type: HostListener, args: ['mouseleave', ] },{ type: HostListener, args: ['blur', ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}