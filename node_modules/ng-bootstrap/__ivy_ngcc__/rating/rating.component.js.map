{"version":3,"file":"rating.component.js","sources":["../../src/rating/rating.component.ts"],"names":[],"mappings":"OAAO,EAAE,SAAS,EAAE,YAAY,EAAE,YAAY,EAAE,KAAK,EAAU,MAAM,EAAE,UAAU,EAAE,MAAM,eAAe;AACxG,OAAO,EAAwB,iBAAiB,EAAE,MAAM,gBAAgB;AAExE,OAAO,IAAM,6BAA6B,GAAQ;AAClD,IAAE,OAAO,EAAE,iBAAiB;AAC5B,IAAE,WAAW,EAAE,UAAU,CAAC,cAAM,OAAA,eAAe,EAAf,CAAe,CAAC;AAChD,IAAE,KAAK,EAAE,IAAI;AACb,CAAC,CAAC;AAGF;AAA4C,IAA5C;AAA6B,QAC3B,sBAAsB;AACxB,QAAU,QAAG,GAAW,CAAC,CAAC;AAC1B,QAUE,wEAAwE;AAC1E,QAAU,YAAO,GAAyB,IAAI,YAAY,EAAE,CAAC;AAC7D,QAAE,8EAA8E;AAChF,QAAU,YAAO,GAAyB,IAAI,YAAY,EAAE,CAAC;AAC7D,QACS,aAAQ,GAAQ,QAAQ,CAAC,SAAS,CAAC;AAC5C,QAAS,cAAS,GAAQ,QAAQ,CAAC,SAAS,CAAC;AAC7C,IAiHA,CAAC;AACD,IA5GS,mCAAS,GAAhB,UAAiB,KAAU;AAAI,QAC7B,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;AACvD,YAAM,MAAM,CAAC;AACb,QAAI,CAAC;AACL,QACI,KAAK,CAAC,cAAc,EAAE,CAAC;AAC3B,QAAI,KAAK,CAAC,eAAe,EAAE,CAAC;AAC5B,QAAI,IAAI,IAAI,GAAG,KAAK,CAAC,KAAK,KAAK,EAAE,IAAI,KAAK,CAAC,KAAK,KAAK,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AACjE,QAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC;AACjC,IAAE,CAAC;AAEH,IAAS,kCAAQ,GAAf;AAAc,QACZ,IAAI,CAAC,GAAG,GAAG,OAAO,IAAI,CAAC,GAAG,KAAK,WAAW,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;AAC9D,QAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,KAAK,IAAI,CAAC;AAC3C,QAAI,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,OAAO,KAAK,WAAW;AACtD,cAAQ,IAAI,CAAC,OAAO;AACpB,cAAQ,gBAAgB,CAAC;AACzB,QAAI,IAAI,CAAC,QAAQ,GAAG,OAAO,IAAI,CAAC,QAAQ,KAAK,WAAW;AACxD,cAAQ,IAAI,CAAC,QAAQ;AACrB,cAAQ,sBAAsB,CAAC;AAC/B,QAAI,IAAI,CAAC,MAAM,GAAG,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC;AAC9E,cAAQ,IAAI,CAAC,MAAM;AACnB,cAAQ,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;AAChD,QAAI,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;AACxE,IAAE,CAAC;AAEH,IAAE,gBAAgB;AAClB,IAAS,oCAAU,GAAjB,UAAkB,KAAa;AAAI,QACjC,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC;AAC9B,YAAM,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACrC,YAAM,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;AAC5B,YAAM,MAAM,CAAC;AACb,QAAI,CAAC;AACL,QACI,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;AAC1B,QAAI,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACvB,IAAE,CAAC;AAEH,IAAS,+BAAK,GAAZ,UAAa,KAAa;AAAI,QAC5B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;AACzB,YAAM,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACzB,YAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC/B,QAAI,CAAC;AACL,IAAE,CAAC;AAEH,IAAS,+BAAK,GAAZ;AAAc,QACZ,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC/B,QAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAClC,IAAE,CAAC;AAEH,IAAS,0CAAgB,GAAvB,UAAwB,EAAkB;AAAI,QAC5C,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;AACvB,IAAE,CAAC;AAEH,IAAS,2CAAiB,GAAxB,UAAyB,EAAY;AAAI,QACvC,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;AACxB,IAAE,CAAC;AAEH,IAAS,8BAAI,GAAX,UAAY,KAAa;AAAI,QAC3B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;AACrE,YAAM,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AAC7B,YAAM,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AAC3B,QAAI,CAAC;AACL,IAAE,CAAC;AAEH,IAAY,8CAAoB,GAA9B,UAA+B,YAAmB,EAAE,GAAW;AAAI,QACjE,YAAY,GAAG,YAAY,IAAI,EAAE,CAAC;AACtC,QAAI,IAAI,KAAK,GAAG,YAAY,CAAC,MAAM,IAAI,GAAG,CAAC;AAC3C,QAAI,IAAI,MAAM,GAAU,EAAE,CAAC;AAC3B,QAAI,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;AACrC,YAAM,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;AAChC,gBAAQ,KAAK,EAAE,CAAC;AAChB,gBAAQ,OAAO,EAAE,IAAI,CAAC,OAAO;AAC7B,gBAAQ,QAAQ,EAAE,IAAI,CAAC,QAAQ;AAC/B,gBAAQ,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;AACtC,aAAO,EAAE,YAAY,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACjC,QAAI,CAAC;AACL,QAAI,MAAM,CAAC,MAAM,CAAC;AAClB,IAAE,CAAC;AACF,IAAM,0BAAU,GAA0B;AAC3C,QAAA,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;AAC1B,oBAAE,QAAQ,EAAE,QAAQ;AACpB,oBAAE,QAAQ,EAAE,giBAOT;AACH,oBAAE,SAAS,EAAE,CAAC,6BAA6B,CAAC;AAC5C,iBAAC,EAAG,EAAE;AACN,KAAC,CAAC;AACF,IAAA,kBAAkB;AAClB,IAAO,8BAAc,GAAmE,cAAM,OAAA,EAC7F,EAD6F,CAC7F,CAAC;AACF,IAAO,8BAAc,GAA2C;AAChE,QAAA,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;AACzB,QAAA,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;AAC7B,QAAA,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;AAC9B,QAAA,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;AAC9B,QAAA,QAAQ,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;AAC5B,QAAA,cAAc,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;AAClC,QAAA,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE;AAC9B,QAAA,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE;AAC9B,QAAA,WAAW,EAAE,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC,EAAG,EAAE,EAAE;AACvE,KAAC,CAAC;AACF,IAAA,sBAAC;AAAD,CAAC,AArID,IAqIC;AACD","sourcesContent":["import { Component, EventEmitter, HostListener, Input, OnInit, Output, forwardRef } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\nexport const RATING_CONTROL_VALUE_ACCESSOR: any = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => RatingComponent),\n  multi: true\n};\n\n\nexport class RatingComponent implements ControlValueAccessor, OnInit {\n  /** number of icons */\n   public max: number = 5;\n  /** selected icon class */\n   public stateOn: string;\n  /** unselected icon class */\n   public stateOff: string;\n  /** if true will not react on any user events */\n   public readonly: boolean;\n  /** array of icons titles, default: ([\"one\", \"two\", \"three\", \"four\", \"five\"]) */\n   public titles: string[];\n  /** array of custom icons classes */\n   public ratingStates: {stateOn: string, stateOff: string}[];\n  /** fired when icon selected, $event:number equals to selected rating */\n   public onHover: EventEmitter<number> = new EventEmitter();\n  /** fired when icon selected, $event:number equals to previous rating value */\n   public onLeave: EventEmitter<number> = new EventEmitter();\n\n  public onChange: any = Function.prototype;\n  public onTouched: any = Function.prototype;\n\n  public range: any[];\n  public value: number;\n  protected preValue: number;\n\n  \n  public onKeydown(event: any): void {\n    if ([37, 38, 39, 40].indexOf(event.which) === -1) {\n      return;\n    }\n\n    event.preventDefault();\n    event.stopPropagation();\n    let sign = event.which === 38 || event.which === 39 ? 1 : -1;\n    this.rate(this.value + sign);\n  }\n\n  public ngOnInit(): void {\n    this.max = typeof this.max !== 'undefined' ? this.max : 5;\n    this.readonly = this.readonly === true;\n    this.stateOn = typeof this.stateOn !== 'undefined'\n      ? this.stateOn\n      : 'glyphicon-star';\n    this.stateOff = typeof this.stateOff !== 'undefined'\n      ? this.stateOff\n      : 'glyphicon-star-empty';\n    this.titles = typeof this.titles !== 'undefined' && this.titles.length > 0\n      ? this.titles\n      : ['one', 'two', 'three', 'four', 'five'];\n    this.range = this.buildTemplateObjects(this.ratingStates, this.max);\n  }\n\n  // model -> view\n  public writeValue(value: number): void {\n    if (value % 1 !== value) {\n      this.value = Math.round(value);\n      this.preValue = value;\n      return;\n    }\n\n    this.preValue = value;\n    this.value = value;\n  }\n\n  public enter(value: number): void {\n    if (!this.readonly) {\n      this.value = value;\n      this.onHover.emit(value);\n    }\n  }\n\n  public reset(): void {\n    this.value = this.preValue;\n    this.onLeave.emit(this.value);\n  }\n\n  public registerOnChange(fn: (_: any) => {}): void {\n    this.onChange = fn;\n  }\n\n  public registerOnTouched(fn: () => {}): void {\n    this.onTouched = fn;\n  }\n\n  public rate(value: number): void {\n    if (!this.readonly && value >= 0 && value <= this.range.length) {\n      this.writeValue(value);\n      this.onChange(value);\n    }\n  }\n\n  protected buildTemplateObjects(ratingStates: any[], max: number): any[] {\n    ratingStates = ratingStates || [];\n    let count = ratingStates.length || max;\n    let result: any[] = [];\n    for (let i = 0; i < count; i++) {\n      result.push(Object.assign({\n        index: i,\n        stateOn: this.stateOn,\n        stateOff: this.stateOff,\n        title: this.titles[i] || i + 1\n      }, ratingStates[i] || {}));\n    }\n    return result;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'rating',\n  template: `\n    <span (mouseleave)=\"reset()\" (keydown)=\"onKeydown($event)\" tabindex=\"0\" role=\"slider\" aria-valuemin=\"0\" [attr.aria-valuemax]=\"range.length\" [attr.aria-valuenow]=\"value\">\n      <template ngFor let-r [ngForOf]=\"range\" let-index=\"index\">\n        <span class=\"sr-only\">({{ index < value ? '*' : ' ' }})</span>\n        <i (mouseenter)=\"enter(index + 1)\" (click)=\"rate(index + 1)\" class=\"glyphicon\" [ngClass]=\"index < value ? r.stateOn : r.stateOff\" [title]=\"r.title\" ></i>\n      </template>\n    </span>\n  `,\n  providers: [RATING_CONTROL_VALUE_ACCESSOR]\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'max': [{ type: Input },],\n'stateOn': [{ type: Input },],\n'stateOff': [{ type: Input },],\n'readonly': [{ type: Input },],\n'titles': [{ type: Input },],\n'ratingStates': [{ type: Input },],\n'onHover': [{ type: Output },],\n'onLeave': [{ type: Output },],\n'onKeydown': [{ type: HostListener, args: ['keydown', ['$event'], ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}